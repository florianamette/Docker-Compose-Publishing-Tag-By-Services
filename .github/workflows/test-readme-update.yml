name: Test README Update

on:
  push:
    branches: [main, test]
  pull_request:
    branches: [main]
  workflow_dispatch: # Manual trigger only for safety

jobs:
  test-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Test with README update
        uses: ./
        with:
          docker_hub_username: ${{ secrets.DOCKER_HUB_USERNAME }}
          docker_hub_org_name: ${{ secrets.DOCKER_HUB_ORG_NAME }}
          docker_hub_org_token: ${{ secrets.DOCKER_HUB_ORG_TOKEN }}
          docker_compose_files: 'test/docker-compose.test.yml'
          docker_hub_repository: ${{ secrets.DOCKER_HUB_TEST_REPOSITORY || github.repository }}
          update_readme: 'true'
          docker_hub_personal_token: ${{ secrets.DOCKER_HUB_PERSONAL_TOKEN }}
          readme_path: './test/README.md'

